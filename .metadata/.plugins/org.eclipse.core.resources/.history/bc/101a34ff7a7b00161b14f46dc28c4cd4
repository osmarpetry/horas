package br.com.osmar.horas.modelos;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;

public class RelatorioHoras {

	private List<HorasPorDia> horasPorDia = new ArrayList<>();

	public RelatorioHoras(List<HoraLancada> horas){
		calculaHorasPorDia(horas);
	}

	private void calculaHorasPorDia(List<HoraLancada> horas) {
		if(!horas.isEmpty()){
			double horasDoDia = 0.0;
			Calendar dataAtual = horas.get(0).getData();
			for (HoraLancada hora : horas) {
				//Para validar se mudei de dia
				if(hora.getData().equals(dataAtual)){
					//Se trabalhar menos que 8h por dia, vai ser horasPorDia
					double horasNormais = Math.min(8.0, horasDoDia);
					//Horas que trabalhou - 8
					double horasExtras = Math.max(horasDoDia - 8, 0);
					HorasPorDia horaPorDia = new HorasPorDia(horasNormais, horasExtras, dataAtual);
					this.horasPorDia.add(horaPorDia);
					dataAtual = hora.getData();
					horasDoDia = 0.0;
				}
				horasDoDia += hora.getDuracao();
			}			
		}
	}

	public List<HorasPorDia> getHorasPorDia() {
		return horasPorDia;
	}

}
